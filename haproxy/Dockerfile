FROM haproxy:2.1.2

ARG BASIC_AUTH_USERNAME
ARG BASIC_AUTH_PASSWORD
ARG BASIC_AUTH_REALM
ARG HAPROXY_HTTP_SCHEME
ARG HAPROXY_STATS_URI
ARG HAPROXY_STATS_REFRESH

ENV BASIC_AUTH_USERNAME=${BASIC_AUTH_USERNAME}
ENV BASIC_AUTH_PASSWORD=${BASIC_AUTH_PASSWORD}
ENV BASIC_AUTH_REALM=${BASIC_AUTH_REALM}
ENV HAPROXY_HTTP_SCHEME=${HAPROXY_HTTP_SCHEME}
ENV HAPROXY_STATS_URI=${HAPROXY_STATS_URI}
ENV HAPROXY_STATS_REFRESH=${HAPROXY_STATS_REFRESH}

COPY ./haproxy-${HAPROXY_HTTP_SCHEME}.cfg /usr/local/etc/haproxy/haproxy.cfg